import 'package:blockchain_utils/blockchain_utils.dart';
import 'package:test/test.dart';

void main() {
  _testVecotr_();
  _bindingVerification();
  _spendAuthVerification();
}

void _testVecotr_() {
  QuickCrypto.setupPRNG(ChaCha20Rng(List<int>.filled(32, 12)));
  test("RedJubJub testvector", () {
    for (final json in _tVector) {
      final tv = _TestVector.fromJson(json);
      final sk = SaplingSpendAuthorizingKey.fromBytes(tv.sk);
      if (tv.rBytes != null && tv.sBytes != null) {
        final sign = sk.sign(tv.m);
        expect(sign.rBytes, tv.rBytes);
        expect(sign.sBytes, tv.sBytes);
      }

      final vk = SaplingSpendVerificationKey.fromBytes(tv.vk);
      final rvk = SaplingSpendVerificationKey.fromBytes(tv.rvk);
      final sig = ReddsaSignature.fromBytes(tv.sig);
      final rsig = ReddsaSignature.fromBytes(tv.rsig);
      final alpha = JubJubFr.fromBytes(tv.alpha);
      expect(sk.randomize(alpha).toBytes(), tv.rsk);
      expect(vk.randomize(JubJubNativeFr.fromBytes(alpha.toBytes())), rvk);
      expect(vk.verifySignature(sig, tv.m), true);
      expect(rvk.verifySignature(rsig, tv.m), true);
    }
  });
}

void _spendAuthVerification() {
  test("RedJubJub auth", () {
    for (final t in _spendAuth) {
      final s = BytesUtils.fromHexString(t[1]);
      final vk = BytesUtils.fromHexString(t[2]);
      final msg = BytesUtils.fromHexString(t[0]);
      final k = SaplingSpendVerificationKey.fromBytes(vk);
      final signature = ReddsaSignature.fromBytes(s);
      expect(k.verifySignature(signature, msg), true);
    }
    final msg = BytesUtils.fromHexString(_spendAuth[0][0]);
    for (final t in _spendAuth.skip(1)) {
      final s = BytesUtils.fromHexString(t[1]);
      final vk = BytesUtils.fromHexString(t[2]);

      final k = SaplingSpendVerificationKey.fromBytes(vk);
      final signature = ReddsaSignature.fromBytes(s);
      expect(k.verifySignature(signature, msg), false);
    }
  });
}

void _bindingVerification() {
  test("RedJubJub binding", () {
    for (final t in _binding) {
      final s = BytesUtils.fromHexString(t[1]);
      final vk = BytesUtils.fromHexString(t[2]);
      final msg = BytesUtils.fromHexString(t[0]);
      final k = SaplingBindingVerificationKey.fromBytes(vk);
      final signature = ReddsaSignature.fromBytes(s);
      expect(k.verifySignature(signature, msg), true);
    }
    final msg = BytesUtils.fromHexString(_binding[0][0]);
    for (final t in _binding.skip(1)) {
      final s = BytesUtils.fromHexString(t[1]);
      final vk = BytesUtils.fromHexString(t[2]);

      final k = SaplingBindingVerificationKey.fromBytes(vk);
      final signature = ReddsaSignature.fromBytes(s);
      expect(k.verifySignature(signature, msg), false);
    }
  });
}

const List<List<String>> _spendAuth = [
  [
    "101cbe4b9c42604f04c703c396f788c6cb2d6d7d58f45430b12eb2edd640076c",
    "b8489300b82a701784a1929a60e4791339393b8ed1e9971d09378e99477ccb4ccbb7a5271431e618a2e89cb073b8bf7a1b67f30fe248b1db43b05f1b6c28450a",
    "b5f1895d2e2a4dec2af0fe9c6692ec2ca65d55e4765a6d8a19462eca3dffd804"
  ],
  [
    "6c3828ff680bdba6629a99434bc24f1156731aaf96ade4d14277215e57bb1331",
    "4f33b475d77c88827d3284dbc4101c5544a3363e562473b41c2369e0011fa5ba1a32fc2e8bdbeab6607e615edd3d135a8fa6c807b986b70251ffa88222198e0c",
    "208a8d31e82bf11642152dabf5bf734eda47e81031f6bdc7efab77ba92b3fc9b"
  ],
  [
    "913fe528dd2e8180442a949557606d5ebcc5755f49ff0bd6c629f9e21682a3d7",
    "4806309587a18922e9f97996e400a5786a1b15f99e6d80c149ec0e5615f8a02c1bdfb78b1379eeecc228f3f9df0fbf41b607173d4c46250b2d62d0da5161430c",
    "d18cd38d51027cd33c766afd8dfdc01e02d882eff337304121046e47f7ac0641"
  ],
  [
    "d0f3cdf9316b2321cea563f8a0ba2732479ce2a40911a29ec69a0a7bbdddf774",
    "6026f0dda39d67186558b43342955ebb14ec757d76ae1662f92e4c56b7578a1d2667641d9cafe890ba0a62eddc627453e63a265bf1a226d826f8332374e5f501",
    "13f4021a9a76d22325a76e4d26ab5c9796fb3fa08acbe1ab2c2fba7f1a5e9145"
  ],
  [
    "49351bbc1e4a4b88d81673b3290c6587f1d0b1e2036d78300278961b1d3b3db4",
    "cbf4815e9c208adf517cc6b5ad5bf384df513547319fc5b1c002240ea532589ed3c96e77f750434735aa144301432f4913fdfbaf795ea23a7e2a0d5521860402",
    "2fdeb6671fb35adbfac380d529ba3ee89c44cd342b4749d4066cd9499ca69166"
  ],
  [
    "9e379aa38a2b38a9d1b8e156278300c23e7a54b0c57358d82f7f2483d7cdfb45",
    "fd9fa6043a25dc1a9f7b4572ca02718867fbb51b8f877559fbb143561a2740c2c21013f2bd9d8009110694c22ba4ee9c0f873e63f73af668a218cd98c1d67605",
    "118401fb24e94ec67a23e7f7af0fd6252512f71410a54285f34b454e05652aae"
  ],
  [
    "d9654c0b28ca81bebb545c44b5be4259e97a483162262881704377273de68c6b",
    "5ed35f61721f61585e89bdbacee49d0a945e726db2b68ac7df37e6ae4cc7bb1cfadd556064d91881db1b0a61c37094d23ebc3d5d5ab96b3ab17b51dcdbc77700",
    "f4ad511dfe183ecfc6a52857fbde634a1abef0b5b084106d958f828c0f974f6c"
  ],
  [
    "0ad44c8b2fea49e983df6465a1171aa10c6b1b4c32e8a5ea22aa7ea9b307a8d8",
    "8bc780cae084c4d2f448558eb8f8b056ad46cde0a1ea33fdefb651abc0c9b486d4846591faf412fc0e961a8cc5f1d1e2d962528783a75b92be7d9398afdde803",
    "44b36b17c7d7edd70c4e5cf485b1732ea772ae0a4626e866041be5ee0580569b"
  ],
  [
    "07799dfabcfc6cd93857b72d6281e9d2798fadc3ac029a7db09403ea03fa7f74",
    "c80a54a3626fe28ce1fad0a568c5004476ec4da08e2689c0498f30c08302d4d9bed4726ae8b29c1219746596d0f8deb79f13b553d3997a695c760ad06d0e0e0a",
    "6f0a1fe7a13a0adc020b9bd49644676de352241666040338400422abc62e66a1"
  ],
  [
    "a1620f5db81fc1d054ea26e5d0cf1bac98aa278abb58c352fd6c65806e5672f2",
    "1229f327c00c18e54ac5aea2d6989f5cdc34afb2aa91f015a10a8531d8c0e81c77f5a33a3fcffd2a860ccc19a9df429884b2beff01c178ed11a401ac920bb002",
    "1d1774b74e64794d3d534473f77f665ad86e56fa2b6efa22618463b6922d544b"
  ],
  [
    "7b070b77f3ede5a0f2a3add8755e081d70b21732b44b12bdd7dd150856d1b157",
    "56ec9451b746d1a502b86f19ce15c3701063b9a102131b3550852727e3675e8c000a1cf3ff83a3aacee57463993463cdb185f73f2b4e9a69a13744b1d311840a",
    "1de6d11cee668adcdf82a94fc5855ab7d6ccbe640059dda43c83eb154496ccae"
  ],
  [
    "b55ec6c74ec2407692334f4649ce5733600d91c64ef5b3b6a9935f894d21f704",
    "ec5c38fc8e3e4054c0a00277a4c926f86616e1410dd3ec60df386ccd3137b1160b42a57872399051aa3277298a976df8d38dd06ef14a59532ce596131614570e",
    "94cb616ee70990f993f4d75e989d4cc0b439b0fa583ea2f2cfc22b1fe083153c"
  ],
  [
    "6c9092d5fe453050ac031aa15a843200c0656241a7c7af931db1d9e248e95d76",
    "3886addcbb9ff8f1c0415b14918dc0766553b4e194a803ead122490808ea52bf87bf9701cd9ee023904d83d1501a76bd274cf614251a10462445fd1afbe69b0a",
    "ad8d8f1193eef5c2f9b2143023c0109d96168269950ef2a93f74c17929c48c32"
  ],
  [
    "6ae80f728931383e1c2ab0c99c566dea03bf2ce7166e6718cc47cf50ff2296d0",
    "6f424098f89f02fe40b46e889d507b8aa96a56b469836d34fc463056e623b5589ead4943c860f3c01822f23671c7d67627f48efe8fbcd98abe89c9f99a74810a",
    "2b35eb1b673ca3734ee105b271375d5ad2bf00f9af50488c16ad51ed0ab03014"
  ],
  [
    "7371367014af91379c6608375ebc49972dfa3754b01664ee66b12c9a31455d40",
    "323c9c861dd4db54f485dbd1adfd5fff21ed707d76ed355d8882f451d05a27ca986f23daffa7ad05a05061686daeff6cabc05bd16cd3919da0480389b03bf10d",
    "3be7923ed977fb2a4b9bd67e385145ab4ae92e190173c0e88785b61006ffb98f"
  ],
  [
    "5dcba9467ce7a3b22888f1b525e75dd0502da6d83fa993756ddf1a4c047d4173",
    "328f81b2e7994dd7f00b46ee74b80f35f140daf8714070442cfd2bb095bec61f9f173796cde4ffc2b05d9664fe5205692fccab89d2b885ea29f215dde2036005",
    "dfed1a2094c9a98a028cc172fb09a53aa2dd1556e351466e491a3caec9ca9b08"
  ],
  [
    "0a12908d2e63980adcb30a1f416de60ff52eeb0295bca3cb6e627d81659bcdbd",
    "c55ca02729824fc956055e13d4ddb024550a0ae939ebc34fecf5aa500aa5a3a209a6dbe784e94efc57a068252442fc082782e35bd7ffa76fb6158fdc58e9480a",
    "663be45830daf0d0d2a6584af84c039ff822a3a6fb33967ff797527ca76859ba"
  ],
  [
    "bcfdd3fcc7367ede0e1f507ca10ac727f82d9a44a2e37d6bac292997eaaba488",
    "69932f00d37a0a0d9f763be395dfed02e1a7421131d90f8bd299d7f9a8b29c3d806448546c54f5117b4e40dcfd3f729db00103572479f6f4589954ad8faa1b02",
    "4b1d846a44c3e99e805d6046632b2b137ea2b020484fc2083bcb10db55e211c6"
  ],
  [
    "e2e371486cef82251579459e9f1ebb14198112d398edd9e167ade154820e6298",
    "ed587874bf1183910e1d349083ec8b48dc931dda89a2f29267738ce9446f249cb3125cbc9ad39f984c38300b3543f92fec48365a910d7081c9ea27285e6eb502",
    "477b0753a670602948157cccdcf272128872bc036d59cf8ed3dc4baa8a9f5b41"
  ],
  [
    "e1f2d5834bce79010ba9a9f12971ff8a6dd891a662515569b24c08d503190fa4",
    "da2784282e2810c4d66ed3e5c8d09243a99e426eb8a67578101b69b0244abb67f5ba3be9abac7819b6db5437dbf2278a594a01c1b8c2bcbe71881e9eb65bd700",
    "6fdca7120e6193a5a09b15ff7fb077edd27063c142a6a7b46cc699e35e55e80d"
  ],
  [
    "e12f57667d56824f93b81a8ae6e5feb4bffc096b1d7e65366286e4696d8f762a",
    "c52be78f52dc18f35075012796854d281ab25f9e4f3cc28f6280f4ff41bfefb35c9f69cf8aa12618c9e8e6ccc89d5dc3b24758f2ad4d003810a5e3bc28319b07",
    "fbaccc8f1e866cf37768a15d2b3256056e97f93067dd594feb74f5675eaaace3"
  ],
  [
    "d0b17c0ee24602fbe77d5a107b492f689f8736834df4ea6ab2099ca96be9eabb",
    "01e9c620998e36b44f4dc2c5311f3bbff5e4cac36143b6739750cfb7c657b381085c1ca4d1cb2e3aa01a9d0895a3d6717f25d47db3b15ff4bd15f648b7b8b909",
    "f6fc5130007b294e48743d49f8e504ea989530c6890ee7f0f2cd9f6309b7681f"
  ],
  [
    "473d39debe01788bee30ed9734c9f215c81d3602c19908494eba9cb7e07ea434",
    "d10439d54681ded081822385cc592ffa6bb0d2b333adf07092708a01f4577490fab21b7d3d7dbacef9ad3c8ebc596066f62bb8609dbef07ba9bff908b740aa0c",
    "f3ddbec7a54298171a1fbcdac423b126a937d48494ac7c81e8eea29ae0509a6d"
  ],
  [
    "586884279fb510e2a7e654875a0f911758635313e09088740821c954141fbdcb",
    "c617d485fcbae5a7eba2b2d4836e2c8cdb933dca75cf41c8eaf41f5e7e7d4981770ff1ddd446f5bcb27003f5596dc12c00c36133a7933a4baaac39d99f26da07",
    "6e69224e150a16b81f9e511950145086f99e994febb742e3cc2530625a10b0b1"
  ],
  [
    "ea04f828e1e5f4761abb3ff60bb0356c33360284bf1008556f96e45e50c0909f",
    "da3e317c5604e65921bd78601860fcfe8f17ed6e8b4c9c8813e31b5f231b8b2907895efaf4b61512b3539500d91afe990a7ca3eeae61f71b197a17d997aeaf04",
    "1870d280cd297bd96fc61bb72f8979b0e0c7e8963c023d4dadde96d26f757229"
  ],
  [
    "bc7c34d1d2306172e529ac296a2b836a1a6b20186c2fbc63ffc1172b8c67bc58",
    "25c21fc1f6924cca6137539b22aae39ae98103b9ab48914c29513038bf69883a837177f670e03d6216c228c5a692fa0cb523a9d850d1f5f455f24aec61c2440c",
    "a97bb1349cdefebe8f7923b1aa933af6d220d5df66cdb39e073771702441ca6e"
  ],
  [
    "115fb9afdb56403aae15c99681fa2414c36e0071b618ce4944107497d900b7a4",
    "096ebfaf698f4c7d624f22c8a7ec3f6c8382f54ad6448aefa3fa313422bc430277e55a5b99ec97d86930a494a5d16a141416edc867c23e37be1c1ad2b7c5a701",
    "ce400c693f14d2b008d4f8c9a496de31a62777d946f8086eb90b45452447f433"
  ],
  [
    "ed85972e924d3d7b46853adf6b61e551573ecfc361aa0f52d3051459a3d98023",
    "e7f6f895c25c77fee41ed2800ffd6aa693e1eae9ed2b24fb0aa56ca7e8df19302f6aee4f2c930ab9845f2991f688dae5c4a796b7131f0ca6ba795fff90199106",
    "4b00bfb30026c867f0e8927f30ff8f4e7e25e1fec0e835ad6cfdd75769af8441"
  ],
  [
    "6d60715943872b9d2825b1997b3f28a37b51887196d158b0d03ad0a0561ae142",
    "4b69ca76e9a3ee3177fc885c139132a5b6b2bbf93bc992bf89411248745561ba4a1168c88d6626500d44e78a4c0e20a73e259c7e17514ce346f60bbb9097f208",
    "b3e052fb9b11102db973cbd3c474e127e012dec15cd0aab0e8352297eba7ed21"
  ],
  [
    "d84e41130917cbd311d0b4d79b418c4bbcf1a252bed75ad9dca01fa8ddacb681",
    "50df2aefe80c985f5e535b4eeaa7b49e03b3b4422639870d3023212e7ecac0544c1f9ca49d86bbce10f1a5a66346963ee92ab57b44fddbf15a41181613f8660a",
    "f288b059514fa87cc1f55cf5363b84dd953c3bef8dcf925083da16091a2c4ed9"
  ],
  [
    "71ad33f21437601a662df99d565eab16d7219c7967615f6257e299363c538c7a",
    "f573606b9580fbc50fa2e7fa16e453dd63c6373afc96a7532fe3e23020f570e29c4f8093ab4868656ff1e95025a30d40487c444e43ccbe775177e4eebf7e3205",
    "f3df94bec5d98e280514d777fcc3b4032fba3948881c8f4bd50beeb769f900ee"
  ],
  [
    "31484a67f8d536714af609174735a9f663e097c3fc74c90489692a5c466c96e3",
    "b0509f2bc08ace7efbe08f90638cb6abf2bd5a530455d2d32c3eebe577f04938a72c1d946e683a59849226a32c15940ff85b556417478c2d22c106f864018c05",
    "42113dba22c5754bd7403072a88bc95ffa20f26641c6619dfae4d37a8c6b1649"
  ]
];

const List<List<String>> _binding = [
  [
    "101cbe4b9c42604f04c703c396f788c6cb2d6d7d58f45430b12eb2edd640076c",
    "ed576ae23c0bcff22e544ce7b7e289a8ac5185a6d0763785669bec101ed0445416536aa1d108b36352effc63ee5782f6855fe72b7a0afb58e3c755d246a4be0d",
    "e7c08ed9d1224ed581d55320da7d833eecbdee17eceb65b6f10275f853125e85"
  ],
  [
    "6c3828ff680bdba6629a99434bc24f1156731aaf96ade4d14277215e57bb1331",
    "19b9937a3debbf203b38fa9a311394cdc3c93c8385eedd32ed5107d374d9cd73ec67d0204b082ffa90b8836c8c35976a80a313450f2a5272ea22bf9f39f12409",
    "15091deff0f2291069c6c8d4cf114c584b4fdf9dd972664ea98cf4049849d82f"
  ],
  [
    "913fe528dd2e8180442a949557606d5ebcc5755f49ff0bd6c629f9e21682a3d7",
    "97a226448408d5fc51380cf2393db6dd6f42da8fb8d2eb7d12e29d80d5605954d0a7403c39f02be67c9410e929c2daab0afa195df347d5574afad6df1e34c103",
    "d020a1a49ec174481f539576838a8c36155cbc1f7ccc9048bafd5704c18a829d"
  ],
  [
    "d0f3cdf9316b2321cea563f8a0ba2732479ce2a40911a29ec69a0a7bbdddf774",
    "8117b868574d54663e953d72dcc315c2732c1a1e481e563db34a4610c000dcc381d1703de2ac847f3467d5d9d52aca06b3b807111d051c18bd1287053a765d04",
    "0fca45a7e6f8052447135eba601606e83b63839464d833c38159ee385132f5dc"
  ],
  [
    "49351bbc1e4a4b88d81673b3290c6587f1d0b1e2036d78300278961b1d3b3db4",
    "9e91d61bb37fc730500de2c56f1348b749332293f1ec15a063daca49e77b3ef394772ab991e1efb1849d6500d23f48163e8234de240d7c00d08dea0326cf480d",
    "0da7941d8d800a826924bc1da9b0aca9a2155a03b4dd445afc9a3e3d142f7791"
  ],
  [
    "9e379aa38a2b38a9d1b8e156278300c23e7a54b0c57358d82f7f2483d7cdfb45",
    "f4131473a0e413413d0576fc62a65f089858aadc81e9a9fc639d773ff39e52aaf8c0c56f97edc33680693e22b176e07bb9bcd40e3838b1d09fbee5612be74107",
    "5961a2e57910aa94266722d4c8c6a4338fbf072ab2d061ece67101c55227cb53"
  ],
  [
    "d9654c0b28ca81bebb545c44b5be4259e97a483162262881704377273de68c6b",
    "daf775d5d08edc2cd8608984941f989c71451cc195501e853799976537b439de7b2558070f1a06ba65ec38821fac494710f8670f8d1839779de42afd782b6201",
    "7ab2cacd6a919b79b28eabcc855edbb93ade492cf5c69e8ef6d61d716e37ea5f"
  ],
  [
    "0ad44c8b2fea49e983df6465a1171aa10c6b1b4c32e8a5ea22aa7ea9b307a8d8",
    "30e8956044e5ccdd290fa3d35445dd90bd8d90012ff361c3f7f6782bdc72585f5ebff0d6cd91de668648af7357d876017a70ba29a7b3a7783bde31e2c9a6d205",
    "b022903899f899e16d265db85a5efed5f20ff5d405c83230c3f9c54bf93a3b41"
  ],
  [
    "07799dfabcfc6cd93857b72d6281e9d2798fadc3ac029a7db09403ea03fa7f74",
    "ec31299243cfa5cf79b0961a2ecf7670e21f13623961b7d7e39065ffa30fba68e7d4ed9ff04ebcb14a6d75d302025862d053eb3dc272b208d7cfafce9cb7d404",
    "722d7870d42461825449baab49d070a6c1a18b8a21bf7a70adfd738719d8a580"
  ],
  [
    "a1620f5db81fc1d054ea26e5d0cf1bac98aa278abb58c352fd6c65806e5672f2",
    "fa52a4405f60cabeba7ca23040b9cf199fc59432b4370a0b0122dbc2d7a0bbcca1b0e82b812b11b750df37273aa078a2f75c40e9915188819ea82fc111f38d00",
    "3390dbf6da55f32aded02010edf4838b458ba4e70eef405ec07f5661e4327b41"
  ],
  [
    "7b070b77f3ede5a0f2a3add8755e081d70b21732b44b12bdd7dd150856d1b157",
    "194487ebbcef9c093f2b41b2f172e69c5e7672617947ceb99037f1e9fe6fd127ce08d96db447afebe22765f1e7930e79fa6bd4e4c93f86e86e652b28d153fe0a",
    "c4ef6a192c9b88f03c6c88ec9610254759cd1fa60d881f697e373fdf4f7b2990"
  ],
  [
    "b55ec6c74ec2407692334f4649ce5733600d91c64ef5b3b6a9935f894d21f704",
    "c9c3535153dbe564abbc8a1c34a3d70c210ca33492404ad494c3fff260576ad4aecc1f8a9020bf15c13f04cc7ef8ab3d139c72f42e12a09cd353d89cde836906",
    "aad30fd93e63448c577a4196185b3eb7cd2bdef14559d5eb33d69cee4377ef3e"
  ],
  [
    "6c9092d5fe453050ac031aa15a843200c0656241a7c7af931db1d9e248e95d76",
    "558c28fa24341fa14fda8c6a9b0f81cae3ce486eb086da47138ba4e694372206f5115f13fd15159c77d519c91f821cd702007838f886e0528a3296869056b002",
    "058428979d0de9b6910594b99d3c1abb018e57ec2dab3fc0961b034181782f89"
  ],
  [
    "6ae80f728931383e1c2ab0c99c566dea03bf2ce7166e6718cc47cf50ff2296d0",
    "4c8fc5ee5f0af7f8deeb62c9837ce36909fde910337a3e60fd1192f75a5ae22d0094dbb2f5bc0e83f19936417cb070a175829ad4a9dee37b179f2bd4f0c36902",
    "81edb720fc253e09bfb76eddd093c39baa5aa53e94efb86005c1fbaf68165614"
  ],
  [
    "7371367014af91379c6608375ebc49972dfa3754b01664ee66b12c9a31455d40",
    "ad2dcdae729f3e4a4001a85cf179377ca037fa47e6e487471ce89987f969b355a955967ea8acfd74d950b327f5b98a90cc6f07c2b9f1b806a667d2611b185302",
    "66ff28e08acf08ee4da964422476f0a29c37676741eabea095894bb4c24da366"
  ],
  [
    "5dcba9467ce7a3b22888f1b525e75dd0502da6d83fa993756ddf1a4c047d4173",
    "e5cc45a17ef1d77efe67dfc92d67edd94a96da189ac8f95ef158e786f2d30c4e631f0c3c3feb3e0593e0f3a12ed1417169dc3199d510f485246ec91e23810407",
    "ce72b1483859e99dbe17ef541a67f7dc1f756481367409fe8d15459128f7f06d"
  ],
  [
    "0a12908d2e63980adcb30a1f416de60ff52eeb0295bca3cb6e627d81659bcdbd",
    "b0777b891e16654db50a984854df197793bad5d1fbb0b96e4a6f3e335b55d19ec9c82c1ceb4c6653e439f6457f72cbca066a2c5e9942e6ee1e2c9f1f13976e0c",
    "4083b785c127383dd4427105ccc538a0caf0325dd6345ac96a46be8849996e08"
  ],
  [
    "bcfdd3fcc7367ede0e1f507ca10ac727f82d9a44a2e37d6bac292997eaaba488",
    "119a7e365c968ca0ab5f8d8ffa843b0e323674c39dc8535335a78d5d7d40c55f5f0ee61b028969b934dfa4305a863fb920cc0b937cd8ebefe49130288da36200",
    "44d0c2b606d61894382aa1988ad93bacc177ed38eee1854de00e4b9135058e65"
  ],
  [
    "e2e371486cef82251579459e9f1ebb14198112d398edd9e167ade154820e6298",
    "f651023b4cbb5676efaf2da95131d8cb639f9186f81a4ff711318527496a3cad25819b94e089aee6f2cecd01fef720d4229a159136adea3468286a06f245600a",
    "3153961f0c66b75009b821cfbe11b83fe598b75ab37787c7c13dfb8d84fe3513"
  ],
  [
    "e1f2d5834bce79010ba9a9f12971ff8a6dd891a662515569b24c08d503190fa4",
    "9079468d7d1d5f12586f17c79b13cf9c7678942e26feeb30e47b9ea63ff4e404cae4a0514413bb6b6d9550eedf685bd27316d94a2befbac2855ae0a0dc268c0d",
    "8ae13deb0c2ac1c664d4a67b7975cfaaa41e784a1097efc7300b24a2bbcd4693"
  ],
  [
    "e12f57667d56824f93b81a8ae6e5feb4bffc096b1d7e65366286e4696d8f762a",
    "44a671049315053d7083d27880090e2c0a6c17c42cb9acf3b449dc7af0345e564155848c4a11ac5513e6b44f22a618b48361662cd063ec6b7c02c7c0f1e56a02",
    "7d2bcc39c33b75e17edd1b214f268bb0ba2f0796f2b6dabe175e84038cf5ef12"
  ],
  [
    "d0b17c0ee24602fbe77d5a107b492f689f8736834df4ea6ab2099ca96be9eabb",
    "9888be59a7f28f25b34077c32c7dacdeb8315f12407903d3d5bffcbb3c510c89e45fd8204eebd1f102e4a1844bcb319a51420e4ecd7bf9416a2b48d0b79eb209",
    "7271e7c6eb39beec33f5abe9e122e32190d209466575a3f452a446a2a4caf9ad"
  ],
  [
    "473d39debe01788bee30ed9734c9f215c81d3602c19908494eba9cb7e07ea434",
    "c6b9558abe36e966f7342b6eb035314241a5a6822b9dfa958766fd621fcd3e584625b3f11d3968cc9f6f1cf9fa260d653c652f30c172df24332d2196db45c102",
    "fa1baca2f8409b3926994777cab4bbd7a03ff3450ae272c59aa87fd35235055b"
  ],
  [
    "586884279fb510e2a7e654875a0f911758635313e09088740821c954141fbdcb",
    "18be91601e5b56994deaa6fe4cf59d1798818d5400695c646cc4c57e9c0fd1e632d8ebb1df7436c0866a21526e88362fc68d7b2fbfa381b0a5e0799e77a8db06",
    "cd5c3967784100887d1e198db048bfc6c8460905349b7b1710c46da992e1a5ab"
  ],
  [
    "ea04f828e1e5f4761abb3ff60bb0356c33360284bf1008556f96e45e50c0909f",
    "0d45392c4c2d17271175170662d3a33377f030025849cdbe04cb04fa4b864b520559ffab6d16534cb163e0f354c0537f693d60f76b434e90ce38e6d237960300",
    "072ea59269a0508a72ecd98a096429e7d75cd7e5182081191001f3b000cc9323"
  ],
  [
    "bc7c34d1d2306172e529ac296a2b836a1a6b20186c2fbc63ffc1172b8c67bc58",
    "73e9bd5da70e6e589d76a21dc30bfa7afce0440cf30a9f7f3241eb735b782fd35900b4638cb6d7789210f74a95680d1e40ef374dcc4b5ee7e8d93c0735857c04",
    "fbc973a305280a3fd392504e01106bc79248b48db713c75d21e5cd46208fa336"
  ],
  [
    "115fb9afdb56403aae15c99681fa2414c36e0071b618ce4944107497d900b7a4",
    "05ab471b689b98e1abfa4d408534150bc301f945ef8896b4a48b32845192822773457a18717d87cade4438126f5aaad1e74b5a7dd2c024a807fd9a2f8eccfd0c",
    "e4877dbc4c57650669af696057ca357633ca67d20a9b6a108ed235f8cf837933"
  ],
  [
    "ed85972e924d3d7b46853adf6b61e551573ecfc361aa0f52d3051459a3d98023",
    "5e3a55de7269096f9c3f1811bd50c31dcca800aa2e0cdc021b1fb2cdd992ddf220223ec29d6698a10c0bdc317ec5398f62187fd380bd4f414b589d2f43285f06",
    "cc2b445281e3acfdccf38f8add49ec268f09293426e398cac676edff4105fbe5"
  ],
  [
    "6d60715943872b9d2825b1997b3f28a37b51887196d158b0d03ad0a0561ae142",
    "4ebffd33dfd4c46952bff229754d68d1acca28fd269d360deb9d2f1f58f902c4587ed3ad2f0d6f3570b3b9cb77044a43350bf5b82aa0939ad1f2c4f89f968e01",
    "7869c319d0bb15a8ee4f2c5e600070b3ddbe8d35133d2a30afd294b74f28072d"
  ],
  [
    "d84e41130917cbd311d0b4d79b418c4bbcf1a252bed75ad9dca01fa8ddacb681",
    "997433ee32a7e2b57a6f49582a9ffbd4c214622b307d507407f30dcba9476fa510ec7acb047d6f1460e979478ad7a99a86cd0944c5ecb366e5a8a2f56f556a03",
    "30a179ac1db9a90832bda8828cfec506bc5dfd43c6c6b9d42ae0d9c38154e605"
  ],
  [
    "71ad33f21437601a662df99d565eab16d7219c7967615f6257e299363c538c7a",
    "eb38d89b14fc36b8f9a2747add70ab12b6e9d27454d8454bdb028a57ace932c887bc8837512b6542b0f818d06a832cf0a69fa26b3a7ebe0b163811601bb3ad09",
    "574585b5378741626947afa6a9690b5242faa6c6e8df8214ec0200cfb3419748"
  ],
  [
    "31484a67f8d536714af609174735a9f663e097c3fc74c90489692a5c466c96e3",
    "8a342bab574f24fb6d279b36c86ae7ea4bea8ca8b344b4e3dcd42b2cafb14b6c2fd8b9207e8fcc3a2e7b55e0d6b5f730fc2505bac1a88ecd619924a1b2a29803",
    "4b40a414ef609444ebd00b4d88c0b174c1542ccdef8f2ea233e43d5fa015c866"
  ]
];

class _TestVector {
  final List<int> sk;
  final List<int> vk;
  final List<int> alpha;
  final List<int> rsk;
  final List<int> rvk;
  final List<int> m;
  final List<int> sig;
  final List<int> rsig;
  final List<int>? rBytes;
  final List<int>? sBytes;
  factory _TestVector.fromJson(Map<String, dynamic> json) {
    return _TestVector(
        sk: json.valueAsBytes("sk"),
        vk: json.valueAsBytes("vk"),
        alpha: json.valueAsBytes("alpha"),
        rsk: json.valueAsBytes("rsk"),
        rvk: json.valueAsBytes("rvk"),
        m: json.valueAsBytes("m"),
        sig: json.valueAsBytes("sig"),
        rsig: json.valueAsBytes("rsig"),
        rBytes: json.valueAsBytes("r_bytes"),
        sBytes: json.valueAsBytes("s_bytes"));
  }

  Map<String, dynamic> toJson() {
    return {
      "sk": BytesUtils.toHexString(sk),
      "vk": BytesUtils.toHexString(vk),
      "alpha": BytesUtils.toHexString(alpha),
      "rsk": BytesUtils.toHexString(rsk),
      "rvk": BytesUtils.toHexString(rvk),
      "m": BytesUtils.toHexString(m),
      "sig": BytesUtils.toHexString(sig),
      "rsig": BytesUtils.toHexString(rsig)
    };
  }

  const _TestVector(
      {required this.sk,
      required this.vk,
      required this.alpha,
      required this.rsk,
      required this.rvk,
      required this.m,
      required this.sig,
      required this.rsig,
      this.rBytes,
      this.sBytes});
}

const List<Map<String, dynamic>> _tVector = [
  {
    "sk": "18e28dea5c11817aeeb21a19981d28368ec438afc25a8db94ebe08d7a0288e09",
    "vk": "9b0153b03d320fe23e2834d5d61dbb1f519b3f41f8f946152bf0c3f247d11807",
    "alpha": "ffd1a1273252b187f4ed326dfc98853e2917c2b36379b175da63b9ef6dda6c08",
    "rsk": "6087383b30559b31609085b9009645ceb6a0c6612599d72880728e61244e7d03",
    "rvk": "c1babcb6eae2b994ee6d65c10b9dad5940dc735b07504daed1e46b0709b45136",
    "m": "0000000000000000000000000000000000000000000000000000000000000000",
    "sig":
        "dca3bb2cb8f048ccab10aed77546c1dbb10cc4fb15ab02acaef944ddab8b6722545fda4c62046d69d98f922f4e8c210bc47b4fdde0a1947179804c1ace569005",
    "rsig":
        "70c284504e90f0008e8ed2208f4969727a415ec3102c299e398b6c16572bd9643ee1011766681e406ee6bee3d03ee8f27176e32fbabdded20b0d1786a4ee1801",
    "r_bytes":
        "0c0930df5dcf4ca2afa0a196091a4f021367a4eeba7a7124df274971b60967f1",
    "s_bytes":
        "6132e9b1617a5518157f852678f95c7d6d4b1e274f45f90c35ad15aa138b7609",
  },
  {
    "sk": "059654f961273dafda3b2677b35c18af6b11adfb9ee90b48935e557c8d5d9c04",
    "vk": "faf6c3b737e8e611aafea52f03bb2786e18353ebe0d3139e3c54498780c8c199",
    "alpha": "c30b96208da800e10af02542ce694b7ed76a28299f85998e5d610812681bf003",
    "rsk": "c8a1ea19efcf3d90e52b4cb981c6632d437cd5243e6fa5d6f0bf5d8ef5788c08",
    "rvk": "d524dce7734069758a91f007a869505dfc4aba1720594d4d74f007700e62ee00",
    "m": "0101010101010101010101010101010101010101010101010101010101010101",
    "sig":
        "b5a1f32d3d50fc738b5c3b4e9960729ce4316ba7721a12686604feba6bd748450070cb922406fdfc5d60dea9be3a526a16cfeb877779fb782d5d41395b455f04",
    "rsig":
        "5a5a20d200efddd498dfae2a9ef8cf01281a8919018a824cc7a4983b9a0d4a06ff172079e013d42a2a3a88a6520c86fce3b98e1efaa325832a6a5658d8dd7c0a",
    "r_bytes":
        "b68a093ebcc7363799c45578b3b38566b4e2c5a1d10ec08f14867bac44dcecd9",
    "s_bytes":
        "168b54d630b00aad614317c4933b76a554cb41b0935bcacf6fdea9f1a2c73c09",
  },
  {
    "sk": "ade7abb551c79d0f0e42ef7f1206b87712a84a61dea3f37b42496d7efd12520c",
    "vk": "369ea751762f839d25701a5eeb551ec4f06c1290b3b9c3a724402dec02739221",
    "alpha": "81922529a63ee743fc4fbbac45c4988316bc9b6e428b01a8d31fc1c2a6ca6205",
    "rsk": "774dda0799f7ed828781e25fc4a9e8542829b2ce1ff48d1d6db9fadbb9283703",
    "rvk": "0d92ad6d46edacd023d4d2ef703a6ca0a792cfc4b7da11c2353bc845a27a974d",
    "m": "0202020202020202020202020202020202020202020202020202020202020202",
    "sig":
        "1f3e8a94310c2071a70f9df5e79aa9e8485deccb178bdff9805fcbe6f7d551eee3c3542ca75c9d8d4adc54d72c3dbe28626d20785bb7f588c1a582b893dbb601",
    "rsig":
        "d136214c5d528ea3d4cb7b631a6bb036064973a108b733a5e3a452ab52a659e567cb55d2644e74b6e8426f2a7dd2a04d2dda4935cc3820b77a9c1ab619863c05",
    "r_bytes":
        "ef59655f56c2b73c5c43b60e1aef978b41654b6cf9b701c75eab41270ec87dac",
    "s_bytes":
        "4da70efadd6a5e52913953b3a82f0cb5e8c9156b6166e2fa6d821928cd7e4d0c",
  },
  {
    "sk": "c9d2ae1f6d32a675d09eb0823f467fa921b3284acb35fabdfc994de549b8590d",
    "vk": "2d2f316e5c369ae4dd2c825f3d86460058407184603b212cf3459f36c8697fd8",
    "alpha": "ebbc89031107c44f47889ed4d4375a4114cf8a75dd33b962f2d759d3f4c6df06",
    "rsk": "fd62414c1f2bd3f49416878a805d714435477fbea72e4c1a46c2735354cabb05",
    "rvk": "f0430e953be60bf438dbdcc2303f0e32a6f7ce2fbedfb13ac518f75a3fd10eb5",
    "m": "0303030303030303030303030303030303030303030303030303030303030303",
    "sig":
        "12c78ddd20d30a61f8930c6fe0850fd112bb7be88b1238ea33d6bef881c102d104aa36544a78471c9e2842e6fd42558346cff43127032666eb116f442a28480c",
    "rsig":
        "01baaa26274c149acf12e1ccf5507d56790482f067e5c92b3219ad6bf91118cc3fce8d2a23198a3b290a7bf68c2ac07b5d9062b9f868662bb2524912d4856e0c"
  },
  {
    "sk": "33bcd2864541b8bb7fdc77a19d970f924eaeecf4103c38c8d2b0668142f27d09",
    "vk": "741794e62cf9320c58bac594a2b90e340a6d8a68056f6ed5c7868c5ff3e4d616",
    "alpha": "7ce725a5fef61bd4a1e9c77328e8210eb7292d954c64e99e8bedd07ab3ab0e0d",
    "rsk": "f8760155e5293dbf9eb57748325fc9f9049de5885c65ba60b5ee03970be90e08",
    "rvk": "6662ba09950accd2cea3c7a81290cd5978a62b5ac5bbc48d9f5819cdc9646f0a",
    "m": "0404040404040404040404040404040404040404040404040404040404040404",
    "sig":
        "774ac4673f09f3ac5789b286b5eecbedb257234e8cdfd93f02890978a6bba61169ed48f9e1c9fd1319bd330d2cf5b491010d69b043f4648bff554162c6a6dc09",
    "rsig":
        "7c6c498de001786109b303a4c5dcb7fd075750a0b9df5e1e2a8e7547b7ed70cc0b56a5bfa9657843efd89c66a84f41d2b1b50751196b1e8c0c4498600696a404"
  },
  {
    "sk": "ca3506d6af7767b5790ef0c5190fb3f3877c4aab40e0dd651abbdacb544ed005",
    "vk": "bab6cfb5c8ea3491251b46d52aca25d9e9af69faa9b4e40b03ad0086de59b51f",
    "alpha": "bea387203f43760ad37d61de0eb59fca6cab7560df64fabb9511579f6f682606",
    "rsk": "88d98df6eebaddbf4c8c51a428c452bef427c00b2045d821b0cc316bc4b6f60b",
    "rvk": "11267d14d5e0b2bb3ce099e8ef8449471cbcfc6939a4b348dea2c17356a1e8dd",
    "m": "0505050505050505050505050505050505050505050505050505050505050505",
    "sig":
        "9a25429f3efd9b2f7de29e45128dd7b760f0508cd9582182abaf53dd76c0342ce41b4acf8e0a4824e41108c2026573114b60beecb174012a2bdbeecbaa00b506",
    "rsig":
        "cff5835713be07fbe125bbf27a636add131c9081716c52fda875426d03982cd27ebd14b4227b839615fd0371bfdb8a30abddff74d795f3e27d1d47c629469b08"
  },
  {
    "sk": "bc27838de2a614cfba6c3e922a8f8424d9856f6816f3bc6102313b7faf5c3a0c",
    "vk": "d79be9ff229a2e35f5bca448e5eb4a8aa97fb418029125cfbaa78a91a382b094",
    "alpha": "21a7150e194fedfef90c5d10e420858bca4004040eb681d14e75c4471351cb02",
    "rsk": "26a2a1c49ce76afd3169d3d57a8fa109a38b3f6b236ed72ca8f6cb61d8f88700",
    "rvk": "54bf1be72e6d41208b8aec1161d3ba59519fb93da01a55e678e27520066036c9",
    "m": "0606060606060606060606060606060606060606060606060606060606060606",
    "sig":
        "bbe0235987c6e0ec686ddb8a657266ad605f7b75955bb0e802f88164a0ffe10c3b738504abb3d10562b927b3d29fe9b0d356286aeae5a2ac9e435f20791af800",
    "rsig":
        "6de32b5415d77a905f0903902a117eda793c708e23a54245ba8a8d1fe0267523231565e05709aed96c221fb1f3d042043503ff338585a9bb989c9dd430d6d60b"
  },
  {
    "sk": "b20859b88ee3338a64954f8a9e8e9bf3e7115acf7c6e7f01432c5f7696d2d005",
    "vk": "a81fe6846dbe0a75c0f49b213232beadd1f9a564673d25b91ee0f17ce9caa363",
    "alpha": "44d908e1c15e6bd9380a8b235ace02fac1c08794454bcdb4a6f48cea78a74a04",
    "rsk": "f6e1619950429f639d9fdaadf85c9eeda9d2e163c2b94cb6e920ec600f7a1b0a",
    "rvk": "0b68d50f913cd1b78b59921e1656d576b0eb171ed3870d39fec69441b34b2538",
    "m": "0707070707070707070707070707070707070707070707070707070707070707",
    "sig":
        "446d677c4cfefd024b0aeb37a598cc2eb3d29b0294fe5bb6978e8b43d32b2e4f0956acd13e7e3a63a18fca32d6ab94b94ed033e9a10fc56928bc8a0f4f8e9500",
    "rsig":
        "8de041e709db624ae2be1648b662239cdedf85ecd382268b0e3554bfa0f2081cd641bca04078aa89f7dd2540587ced6b458916b13e4b6a3630da697646dbbf09"
  },
  {
    "sk": "3216ae47e9f53e8a52796f24b62460776bd5f205a78e1595bc8efedc519d360b",
    "vk": "df74bf047961cc5cdac82890c76ec675bd4e89ead280c952d7c33eeaf2b5a66b",
    "alpha": "c961f2dd93682adb93f5c05a73fdbc6d43c70e1b15e8d53e3f17a82494e3f209",
    "rsk": "444ba94e1e50d294635e68b29501b53eae61cd1fbb3b84cd52f6729cfbcbab06",
    "rvk": "0afbe406a891c3b8c310c215bc68a913de7cda06af29420056468d0c08855b28",
    "m": "0808080808080808080808080808080808080808080808080808080808080808",
    "sig":
        "993580ef93349a1c9ee960ca3e7cd04c13b4a0ec4fd18053a19cff7763620965fbee96c1647230e373cb82b81d00039223d30b393ed172c9b3c563c611792205",
    "rsig":
        "cc7aae1cedad2d7f6ce04c19c5a5b6b7a6a082785c540c14f6309b064d1ffa68172953fba0c2fcfb875ca7f7ea98ef55a0402fd529cfcddf996ca2b8ca89900a"
  },
  {
    "sk": "85836f9832b28de7c63613e2a6ed36fb1ab44fb0c13fa8798cd9cd3030d45503",
    "vk": "bfd5bc00c7c022aa8901ae083c12d54b82f0ddff8ed6db9a12d59a5ef6a5a2e0",
    "alpha": "a2e8b9e16d6ff3ca6c53d4e88abbb99be7af7e3659631f1eae1eff23874d8e0c",
    "rsk": "703f32a34113eae1b0791ffe9d8888f001299ae519686091914899efcc6c6601",
    "rvk": "eb9297036cf517e15e9efe3975328db48ee7c2694e946db25f528788f6a1db14",
    "m": "0909090909090909090909090909090909090909090909090909090909090909",
    "sig":
        "ce90ddf4af21aac4d94193ea16ff35cd9379204e7d8ff4c0f54117abb16b7c85a0b197cf13ab14d7c3ba68010ab8051225913bdbc39a51f6037afc6ceecb0b06",
    "rsig":
        "a847742e9401cf2239213dc8813e9772e97af8d67adffeabc8e67f5d2d90d0b41bc25b05f94ace168aecc6583e18f7637492f37a9ca300202bc065abd380ec00"
  }
];
